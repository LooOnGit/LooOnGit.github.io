---
title: "SPI"
date: 2025-07-24 22:41:00 +0800
categories: [Protocol]
tags: [Protocol]
---

# ğŸ”„ SPI (Serial Peripheral Interface)

## ğŸ“ Tá»•ng quan

SPI (Serial Peripheral Interface) lÃ  má»™t chuáº©n giao tiáº¿p ná»‘i tiáº¿p Ä‘á»“ng bá»™, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truyá»n dá»¯ liá»‡u giá»¯a vi Ä‘iá»u khiá»ƒn vÃ  cÃ¡c thiáº¿t bá»‹ ngoáº¡i vi nhÆ° cáº£m biáº¿n, bá»™ nhá»›, mÃ n hÃ¬nh, v.v. SPI sá»­ dá»¥ng bá»‘n Ä‘Æ°á»ng tÃ­n hiá»‡u chÃ­nh:

![alt text](/assets/Protocol/SPI_Connect.png)

- ğŸ“¤ **MOSI (Master Out Slave In)**: Dá»¯ liá»‡u tá»« Master Ä‘áº¿n Slave
- ğŸ“¥ **MISO (Master In Slave Out)**: Dá»¯ liá»‡u tá»« Slave Ä‘áº¿n Master
- â° **SCK (Serial Clock)**: Xung nhá»‹p do Master táº¡o ra
- ğŸ¯ **SS/CS (Slave Select/Chip Select)**: Chá»n thiáº¿t bá»‹ Slave

> SPI cÃ³ tá»‘c Ä‘á»™ truyá»n dá»¯ liá»‡u cao, cáº¥u trÃºc Ä‘Æ¡n giáº£n vÃ  dá»… triá»ƒn khai trong cÃ¡c á»©ng dá»¥ng nhÃºng.

## ğŸ”„ CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a SPI
![alt text](/assets/Protocol/spi_transmit_recv.png)
Trong vÃ­ dá»¥ trÃªn, ta cÃ³ thá»ƒ tháº¥y:

1. â° **Xung clock (SCK)**:
- Cho biáº¿t khi nÃ o nÃªn láº¥y máº«u dá»¯ liá»‡u.
- Khi nÃ o Ä‘á»c má»©c Ä‘iá»‡n Ã¡p.
- Má»—i láº§n truyá»n xong má»™t bit dá»¯ liá»‡u.
- TÃ­n hiá»‡u clock cÃ³ thá»ƒ á»Ÿ tráº¡ng thÃ¡i idle má»©c tháº¥p (idle low) hoáº·c má»©c cao (idle high).
- Dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c láº¥y máº«u á»Ÿ cáº¡nh lÃªn hoáº·c cáº¡nh xuá»‘ng cá»§a xung clock.

2. ğŸ¯ **Slave Select (SS/CS)**:
   - KÃ©o xuá»‘ng má»©c tháº¥p khi báº¯t Ä‘áº§u truyá»n
   - Giá»¯ má»©c tháº¥p trong suá»‘t quÃ¡ trÃ¬nh truyá»n
   - KÃ©o lÃªn má»©c cao khi káº¿t thÃºc

3. ğŸ¯ **MOSI**:
- Sá»­ dá»¥ng Ä‘á»ƒ truyá»n dá»¯ liá»‡u tá»« master vá» slave, dá»¯ liá»‡u thÆ°á»ng Ä‘Æ°á»£c gá»­i theo Ä‘Æ¡n vá»‹ byte (LSB hoáº·c MSB trÆ°á»›c).
- CÃ³ thá»ƒ gá»­i nhiá»u byte liÃªn tá»¥c.

2. ğŸ¯ **MISO**:
- DÃ¹ng Ä‘á»ƒ gá»­i dá»¯ liá»‡u tá»« Slave Ä‘áº¿n Master.
- 
### ğŸ” Äáº·c Ä‘iá»ƒm quan trá»ng

1. ğŸ” **Truyá»n song song hai chiá»u**:
   - MOSI vÃ  MISO hoáº¡t Ä‘á»™ng Ä‘á»“ng thá»i
   - Trong má»™t chu ká»³ truyá»n 8 bit:
     * Master gá»­i 1 byte qua MOSI
     * Äá»“ng thá»i nháº­n 1 byte tá»« MISO
---

### ğŸ”„ SPI MODE

SPI cÃ³ 4 cháº¿ Ä‘á»™ hoáº¡t Ä‘á»™ng (MODE) khÃ¡c nhau, Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi hai tham sá»‘:
- ğŸ”µ **CPOL (Clock Polarity)**: XÃ¡c Ä‘á»‹nh má»©c logic cá»§a chÃ¢n SCK khi khÃ´ng truyá»n dá»¯ liá»‡u
  - CPOL = 0: SCK á»Ÿ má»©c tháº¥p khi nghá»‰
  - CPOL = 1: SCK á»Ÿ má»©c cao khi nghá»‰
- ğŸ”´ **CPHA (Clock Phase)**: XÃ¡c Ä‘á»‹nh thá»i Ä‘iá»ƒm láº¥y máº«u dá»¯ liá»‡u
  - CPHA = 0: Láº¥y máº«u táº¡i cáº¡nh Ä‘áº§u tiÃªn cá»§a SCK
  - CPHA = 1: Láº¥y máº«u táº¡i cáº¡nh thá»© hai cá»§a SCK

#### Báº£ng cÃ¡c cháº¿ Ä‘á»™ SPI:

| Mode | CPOL | CPHA | Tráº¡ng thÃ¡i nghá»‰ SCK | Cáº¡nh láº¥y máº«u |
|------|------|------|---------------------|--------------|
| 0    | 0    | 0    | Má»©c tháº¥p           | Cáº¡nh lÃªn     |
| 1    | 0    | 1    | Má»©c tháº¥p           | Cáº¡nh xuá»‘ng   |
| 2    | 1    | 0    | Má»©c cao            | Cáº¡nh xuá»‘ng   |
| 3    | 1    | 1    | Má»©c cao            | Cáº¡nh lÃªn     |

![alt text](/assets/Protocol/spi_mode.png)
