---
title: "STRUCT"
date: 2025-07-24 19:19:00 +0800
categories: [C]
tags: [C]
---

# ğŸ“– HÆ°á»›ng dáº«n vá» Struct trong c

TÃ i liá»‡u nÃ y cung cáº¥p kiáº¿n thá»©c cÆ¡ báº£n, vÃ­ dá»¥ thá»±c táº¿ vÃ  giáº£i thÃ­ch rÃµ rÃ ng vá» **struct (cáº¥u trÃºc)** trong láº­p trÃ¬nh c.

## ğŸ§  Tá»•ng quan

`struct` (cáº¥u trÃºc) trong c lÃ  má»™t kiá»ƒu dá»¯ liá»‡u do ngÆ°á»i dÃ¹ng Ä‘á»‹nh nghÄ©a, cho phÃ©p nhÃ³m nhiá»u biáº¿n cÃ³ kiá»ƒu dá»¯ liá»‡u khÃ¡c nhau láº¡i vá»›i nhau. `struct` ráº¥t há»¯u Ã­ch khi báº¡n cáº§n tá»• chá»©c dá»¯ liá»‡u phá»©c táº¡p.


## âš™ï¸ cÃ¡ch khai bÃ¡o struct

### Khai bÃ¡o tÆ°á»ng minh
```c
struct structureName {
    dataType member1;
    dataType member2;
    // cÃ¡c thÃ nh viÃªn khÃ¡c
};
```
#### VÃ­ dá»¥:
```c
struct student {
    char ten[30];
    int tuoi;
    char sodienthoai[20];
    float lop;
};
```
**Khai bÃ¡o biáº¿n struct**:
```c
struct student sv1;
struct student sv2;
// Hoáº·c khai bÃ¡o máº£ng struct
struct student sv[10];
```

### Khai bÃ¡o khÃ´ng tÆ°á»ng minh (Sá»­ dá»¥ng `typedef` vá»›i struct)

Khi sá»­ dá»¥ng `typedef`, báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a má»™t tÃªn má»›i cho kiá»ƒu `struct`, giÃºp viá»‡c khai bÃ¡o biáº¿n trá»Ÿ nÃªn ngáº¯n gá»n hÆ¡n.

```c
typedef struct {
    dataType member1;
    dataType member2;
    // cÃ¡c thÃ nh viÃªn khÃ¡c
} structureName;
```
#### VÃ­ dá»¥:
```c
typedef struct {
    char ten[30];
    int tuoi;
    char sodienthoai[20];
    float lop;
} student;
```
**Khai bÃ¡o biáº¿n struct:**
```c
student sv1;
student sv2;
// Hoáº·c khai bÃ¡o máº£ng struct
student sv[10];
```

## ğŸ” Truy cáº­p thÃ nh viÃªn cá»§a struct
cÃ¡c thÃ nh viÃªn cá»§a struct Ä‘Æ°á»£c truy cáº­p báº±ng toÃ¡n tá»­ . (dáº¥u cháº¥m).
### VÃ­ dá»¥:
```c
#include <stdio.h>

struct Student {
    char name[50];
    int age;
    float grade;
};

int main() {
    struct Student student1 = {"Tran cong Hoa", 20, 8.5};

    printf("Name: %s\n", student1.name);
    printf("Age: %d\n", student1.age);
    printf("Grade: %.2f\n", student1.grade);

    return 0;
}
```
## ğŸ“‹ Sá»­ dá»¥ng con trá» vá»›i struct

Khi lÃ m viá»‡c vá»›i con trá» trá» Ä‘áº¿n struct, báº¡n sá»­ dá»¥ng toÃ¡n tá»­ -> Ä‘á»ƒ truy cáº­p cÃ¡c thÃ nh viÃªn.

### VÃ­ dá»¥: 
```c
#include <stdio.h>

struct Point {
    int x;
    int y;
};

int main() {
    struct Point p1 = {10, 20};
    struct Point *ptr = &p1;

    printf("x: %d, y: %d\n", ptr->x, ptr->y);

    return 0;
}
```

## ğŸ“Š Struct lá»“ng nhau
`struct` cÃ³ thá»ƒ chá»©a cÃ¡c `struct` khÃ¡c lÃ m thÃ nh viÃªn.
### VÃ­ dá»¥:
```c
#include <stdio.h>

struct Address {
    char city[50];
    int zip;
};

struct Person {
    char name[50];
    struct Address address;
};

int main() {
    struct Person person = {"Tran cong Hoa", {"Hanoi", 100000}};

    printf("Name: %s\n", person.name);
    printf("city: %s\n", person.address.city);
    printf("ZIP: %d\n", person.address.zip);

    return 0;
}
```
## ğŸ“ KÃ­ch thÆ°á»›c cá»§a Struct
Giáº£ sá»­ mÃ¬nh cÃ³ struct nhÆ° sau vÃ  cÃ¢u há»i Ä‘áº·t ra lÃ  kÃ­ch thÆ°á»›c cá»§a nÃ³ lÃ  báº±ng bao nhiÃªu?
**cÃ¢u tráº£ lá»i:** KÃ­ch thÆ°á»›c cá»§a struct lÃ  bá»™i kÃ­ch thÆ°á»›c cá»§a pháº§n tá»­ cÃ³ kÃ­ch thÆ°á»›c lá»›n nháº¥t trong struct.
![alt text](/assets/C/struct6.png)
```c
struct ST {
    int Index;
    char Team;
};

// Pháº§n tá»­ lá»›n nháº¥t lÃ  Index cÃ³ kÃ­ch thÆ°á»›c 4 byte.
// -> KÃ­ch thÆ°á»›c struct lÃ  bá»™i cá»§a 4.

// Index náº±m trong block 4 byte Ä‘áº§u tiÃªn.
// Block nÃ y khÃ´ng cÃ²n byte trá»‘ng, do con chip
// thÆ°á»ng lÃ  32 bit thÃ¬ 4 byte lÃ  Ä‘á»§ rá»“i mÃ .

// Team cÃ³ kÃ­ch thÆ°á»›c 1 byte pháº£i náº±m á»Ÿ block tiáº¿p theo.
// Block nÃ y lÃ  4 byte thá»«a 3 byte.

// => KÃ­ch thÆ°á»›c struct nÃ y lÃ  8 byte.
```
## ğŸ§© PhÃ¢n máº£nh bá»™ nhá»› (Memory Alignment)
### Data alignment lÃ  gÃ¬? NÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?
   Data alignment cÃ³ nghÄ©a lÃ  khi data Ä‘Æ°á»£c load lÃªn memory sáº½ Ä‘Æ°á»£c cPU sáº¯p xáº¿p láº¡i Ä‘á»ƒ tiá»‡n cho viá»‡c truy xuáº¥t tá»‘i Æ°u nháº¥t cÃ³ thá»ƒ. cÃ¡c báº¡n Ä‘á»u Ä‘Ã£ biáº¿t bá»™ nhá»› mÃ¡y tÃ­nh lÃ  má»™t dÃ£y cÃ¡c Ã´ nhá»› liÃªn tiáº¿p nhau, má»—i Ã´ nhá»› cÃ³ kÃ­ch thÆ°á»›c 1 byte. Tuy nhiÃªn khi chÆ°Æ¡ng trÃ¬nh cháº¡y, cÃ¡c vi xá»­ lÃ½ hiá»‡n Ä‘áº¡i khÃ´ng truy cáº­p tá»«ng Ã´ nhá»› má»™t, mÃ  má»™t nhÃ³m cÃ¡c Ã´ nhá»› gá»“m 2, 4 hoáº·c 8 bytes. Viá»‡c nÃ y nháº±m má»¥c Ä‘Ã­ch tÄƒng hiá»‡u suáº¥t Ä‘á»ƒ Ä‘á»c ghi cá»§a há»‡ thá»‘ng.

**Äá»ƒ cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c viá»‡c Ä‘Ã³ chÃºng ta cáº§n hiá»ƒu 2 khÃ¡i niá»‡m sau:**
- **Data alignment**: sáº¯p xáº¿p data sao cho Ä‘á»‹a chá»‰ cá»§a cÃ¡c biáº¿n luÃ´n lÃ  sá»‘ cháºµn vÃ  phÃ¹ há»£p vá»›i há»‡ thá»‘ng.
- **Data padding**: Ä‘á»ƒ lÃ m Ä‘Æ°á»£c viá»‡c alignment nhÆ° á»Ÿ trÃªn chÃºng ta cáº§n pháº£i "padding" (Ä‘á»‡m) thÃªm má»™t sá»‘ byte vÃ o sau biáº¿n "char id" Ä‘á»ƒ khi Ä‘Ã³ biáº¿n"int age" cÃ³ thá»ƒ á»Ÿ Ä‘á»‹a chá»‰ cháºµn. char cÃ³ thá»ƒ báº¯t Ä‘áº§u trÃªn báº¥t cá»© byte Ä‘á»‹a chá»‰ nÃ o, short-2 bytes chá»‰ báº¯t Ä‘áº§u báº±ng cÃ¡c bytes Ä‘á»‹a chá»‰ cháºµn, int-4 bytes hoáº·c float-4 bytes báº¯t Ä‘áº§u táº¡i cÃ¡c byte Ä‘á»‹a chá»‰ chia háº¿t cho 4, long-8bytes hoáº·c double-8 bytes báº¯t Ä‘áº§u táº¡i cÃ¡c byte Ä‘á»‹a chá»‰ chia háº¿t cho 8. KhÃ´ng cÃ³ sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c kiá»ƒu cÃ³ dáº¥u vÃ  khÃ´ng dáº¥u.
![alt text](/assets/C/Struct1.png)
Nhá»¯ng gÃ¬ báº¡n tÃ­nh lÃ  1+4+8 = 13 bytes, nhÆ°ng káº¿t quáº£ láº¡i lÃ  16, láº¡ pháº£i khÃ´ng nÃ o?
 Äáº§u tiÃªn compiler sáº½ tÃ¬m xem trong struct, thÃ nh viÃªn nÃ o cÃ³ kÃ­ch thÆ°á»›c lá»›n nháº¥t, sau Ä‘Ã³ sáº½ cáº¥p phÃ¡t má»™t block cÃ³ kÃ­ch thÆ°á»›c lá»›n nháº¥t, sau Ä‘Ã³ sáº½ cáº¥p phÃ¡t má»™t block cÃ³ kÃ­ch thÆ°á»›c tÆ°Æ¡ng á»©ng vá»›i member lá»›n nháº¥t, rá»“i Ä‘iá»n cÃ¡c vÃ¹ng nhá»› cá»§a cÃ¡c members theo thá»© tá»± khai bÃ¡o trong struct, khi nÃ o háº¿t má»™t block, sáº½ cáº¥p thÃªm block má»›i. cá»¥ thá»ƒ vá»›i vÃ­ dá»¥ trÃªn:

 compiler sáº½ xÃ¡c Ä‘á»‹nh member gpa kiá»ƒu double lÃ  thÃ nh viÃªn cÃ³ kÃ­ch thÆ°á»›c lá»›n nháº¥t trong struct, kÃ­ch thÆ°á»›c lÃ  8bytes.

 Sau Ä‘Ã³, compiler sáº½ Ä‘áº©y 1 byte cá»§a **id** vÃ o block. LÃºc nÃ y cÃ²n 7 bytes trá»‘ng, compiler sáº½ xÃ¡c Ä‘á»‹nh thÃ nh viÃªn cÃ³ kÃ­ch thÆ°á»›c bÃ© tiáº¿p theo rá»“i vÃ o, á»Ÿ Ä‘Ã¢y sáº½ lÃ  4 bytes cá»§a **age**, compiler sáº½ padding 3 bytes vÃ  Ä‘áº©y age vÃ o 4 bytes cÃ²n láº¡i.
 	
 Váº­y lÃ  háº¿t block Ä‘áº§u tiÃªn, cÃ²n láº¡i thÃ nh viÃªn gpa chÆ°a Ä‘Æ°á»£c cáº¥p bá»™ nhá»›, do Ä‘Ã³ compiler sáº½ cáº¥p phÃ¡t tiáº¿p 2 block 8bytes rá»“i Ä‘áº©y **gpa** vÃ o 8 bytes Ä‘Ã³.

**VÃ­ dá»¥**: TÃ­nh kÃ­ch thÆ°á»›c cá»§a Struct
```c
struct A {
    int x;
    double z;
    short int y;
};

struct B {
    double z;
    int x;
    short int y;
};

struct c {
    double z;
    short int y;
    int x;
};
```
**Struct A**
![alt text](/assets/C/struct2.png)
- KÃ­ch thÆ°á»›c cá»§a struct A lÃ  bá»™i cá»§a 8 vÃ¬ pháº§n tá»­ cÃ³ kÃ­ch thÆ°á»›c lá»›n nháº¥t lÃ  8 byte vÃ  cáº¥p tá»« trÃªn xuá»‘ng nÃªn ta cÃ³:
- Pháº§n tá»­ x kiá»ƒu int 4 byte vÃ  vÃ¬ lÃ  bá»™i cá»§a 8 nÃªn cÃ²n 4byte trá»‘ng
- Pháº§n tá»­ z kiá»ƒu double 8 byte nÃªn vá»«a Ä‘á»§ khÃ´ng cÃ³ byte trá»‘ng
- Pháº§n tá»­ y kiá»ƒu short int 2 byte nÃªn dÃ¹ng 2 byte vÃ  cÃ²n 6byte trá»‘ng
- Tá»•ng kÃ­ch thÆ°á»›c Struct A = 8+8+8 = 24 byte

**Struct B**
![alt text](/assets/C/struct3.png)
- KÃ­ch thÆ°á»›c z kiá»ƒu double 8 byte thÃ¬ nhÆ° trÃªn.
- Pháº§n tá»­ y short int kÃ­ch thÆ°á»›c 2 byte mÃ  cáº¥p Ä‘áº¿n 8 byte nÃªn cÃ²n dÆ° 6byte vÃ  x kiá»ƒu int 4 byte.
- KÃ­ch thÆ°á»›c Struct c = 8+2+2+4 = 16 byte.

## ğŸ› ï¸ cÃ¡ch kháº¯c phá»¥c phÃ¢n máº£nh bá»™ nhá»›
`#pragma pack(n)`: Tá»« khÃ³a nÃ y sáº½ nÃ³i cho trÃ¬nh biÃªn dá»‹ch biáº¿t ráº±ng cáº§n cáº¥p phÃ¡t cho cÃ¡c pháº§n tá»­ trong struct theo n bytes má»™t.
![alt text](/assets/C/struct4.png)
- Ã nghÄ©a cá»§a parama pack lÃ  lÃºc nÃ y chá»‰ cáº¥p phÃ¡t 1 byte 1
cÃ¡ch xem kÃ­ch thÆ°á»›c struct.
![alt text](/assets/C/struct5.png)

## ğŸ’¡ á»¨ng dá»¥ng cá»§a struct
- Quáº£n lÃ½ dá»¯ liá»‡u phá»©c táº¡p nhÆ° thÃ´ng tin sinh viÃªn, nhÃ¢n viÃªn, sáº£n pháº©m, v.v.
- Tá»• chá»©c dá»¯ liá»‡u trong láº­p trÃ¬nh nhÃºng vÃ  há»‡ thá»‘ng.
- LÃ m viá»‡c vá»›i cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u nhÆ° danh sÃ¡ch liÃªn káº¿t, cÃ¢y, Ä‘á»“ thá»‹.