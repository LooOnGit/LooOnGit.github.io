---
title: "BIT FIELD"
date: 2025-07-23 09:45:00 +0800
categories: [C]
tags: [C]
---

# üìñ Bit-field trong C

T√†i li·ªáu n√†y cung c·∫•p ki·∫øn th·ª©c c∆° b·∫£n, v√≠ d·ª• th·ª±c t·∫ø v√† gi·∫£i th√≠ch r√µ r√†ng v·ªÅ **bit-field** trong l·∫≠p tr√¨nh C.

## üß† T·ªïng quan

**Bit-field** trong C l√† m·ªôt t√≠nh nƒÉng c·ªßa `struct`, cho ph√©p b·∫°n ch·ªâ ƒë·ªãnh s·ªë l∆∞·ª£ng bit c·ª• th·ªÉ ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu. ƒêi·ªÅu n√†y r·∫•t h·ªØu √≠ch khi l√†m vi·ªác v·ªõi c√°c thanh ghi ph·∫ßn c·ª©ng ho·∫∑c khi c·∫ßn t·ªëi ∆∞u h√≥a b·ªô nh·ªõ.

- Bits Fields l√† m·ªôt k·ªπ thu·∫≠t nh·∫±m t·ªëi ∆∞u b·ªô nh·ªõ trong struct, trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p khi khai b√°o ta s·ª≠ d·ª•ng ki·ªÉu d·ªØ li·ªáu c√≥ ph·∫°m vi gi√° tr·ªã l·ªõn, trong khi gi√° tr·ªã th·ª±c t·∫ø nh·ªè h∆°n v√† kh√¥ng bao gi·ªù ƒë·∫°t ƒë·∫øn nh·ªØng gi√° tr·ªã l·ªõn ƒë√≥.
**V√≠ d·ª• 1:** Khi minh khai b√°o bi·∫øn bool (ch·ªâ c√≥ 2 gi√° tr·ªã true ho·∫∑c false) tuy nhi√™n l·∫°i s·ª≠ d·ª•ng m·∫•t 1 byte (8bits) cho ki·ªÉu d·ªØ li·ªáu bool, trong khi ta ch·ªâ c·∫ßn s·ª≠ d·ª•ng 1 trong 8 bit ƒë√≥ (gi√° tr·ªã 0 ho·∫∑c 1) l√† ƒë·ªß ƒë·ªÉ th·ªÉ hi·ªán 2 gi√° tr·ªã true v√† false. V√¥ h√¨nh dung ch√∫ng ta ƒë√£ l√£ng ph√≠ m·∫•t 7 bit r·ªìi.
**V√≠ d·ª• 2:** Khi ch√∫ng ta khai b√°o 1 bi·∫øn int tuoi_tac(m·∫•t 4 byte) ƒë·ªÉ ch·ªâ th·ªã s·ªë tu·ªïi c·ªßa m·ªôt ai ƒë√≥, nh∆∞ng th·ª±c t·∫ø ch√∫ng ta bi·∫øt r·∫±ng n√≥ kh√¥ng bao gi·ªù s·ª≠ d·ª•ng h·∫øt gi√° tr·ªã c·ªßa c·∫£ 7 byte ƒë·ªÉ ch·ªâ th·ªã ƒëi·ªÅu ƒë√≥.
**‚Üí V√¨ v·∫≠y m√† tr∆∞·ªùng bit fields s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng trong nh·ªØng tr∆∞·ªùng h·ª£p n√†y.**

---

## ‚öôÔ∏è C√°ch khai b√°o bit-field

### C√∫ ph√°p:
```c
struct StructName {
    data_type member_name : number_of_bits;
};
**V√≠ d·ª•: 
```C
struct Flags {
    unsigned int flag1 : 1;
    unsigned int flag2 : 2;
    unsigned int flag3 : 3;
};
```
## üîç S·ª≠ d·ª•ng bit-field
**V√≠ d·ª•**
```C
#include <stdio.h>

struct Flags {
    unsigned int flag1 : 1;
    unsigned int flag2 : 2;
    unsigned int flag3 : 3;
};

int main() {
    struct Flags f = {1, 2, 5};

    printf("Flag1: %u\n", f.flag1);
    printf("Flag2: %u\n", f.flag2);
    printf("Flag3: %u\n", f.flag3);

    return 0;
}
```
## üí° ∆Øu ƒëi·ªÉm c·ªßa bit-field
### 1. Ti·∫øt ki·ªám b·ªô nh·ªõ:
Ch·ªâ s·ª≠ d·ª•ng s·ªë l∆∞·ª£ng bit c·∫ßn thi·∫øt thay v√¨ to√†n b·ªô k√≠ch th∆∞·ªõc c·ªßa ki·ªÉu d·ªØ li·ªáu.
### 2. D·ªÖ d√†ng thao t√°c v·ªõi c√°c bit:
Th√≠ch h·ª£p cho vi·ªác l√†m vi·ªác v·ªõi c√°c thanh ghi ph·∫ßn c·ª©ng ho·∫∑c d·ªØ li·ªáu nh·ªã ph√¢n.
### 3. M√£ ngu·ªìn r√µ r√†ng h∆°n:
Gi√∫p bi·ªÉu di·ªÖn c√°c bit trong m·ªôt c·∫•u tr√∫c d·ªÖ hi·ªÉu.

## ‚ö†Ô∏è H·∫°n ch·∫ø c·ªßa bit-field
### 1. Kh√¥ng th·ªÉ l·∫•y ƒë·ªãa ch·ªâ c·ªßa bit-field:
B·∫°n kh√¥ng th·ªÉ s·ª≠ d·ª•ng to√°n t·ª≠ & ƒë·ªÉ l·∫•y ƒë·ªãa ch·ªâ c·ªßa m·ªôt th√†nh vi√™n bit-field.
### 2. Ph·ª• thu·ªôc v√†o tr√¨nh bi√™n d·ªãch:
C√°ch s·∫Øp x·∫øp bit-field trong b·ªô nh·ªõ c√≥ th·ªÉ kh√°c nhau gi·ªØa c√°c tr√¨nh bi√™n d·ªãch.
### 3. Hi·ªáu su·∫•t:
Truy c·∫≠p bit-field c√≥ th·ªÉ ch·∫≠m h∆°n so v·ªõi truy c·∫≠p c√°c bi·∫øn th√¥ng th∆∞·ªùng.

## üìã ·ª®ng d·ª•ng c·ªßa bit-field trong Embedded
### 1. Qu·∫£n l√Ω thanh ghi ph·∫ßn c·ª©ng
Bit-field r·∫•t h·ªØu √≠ch ƒë·ªÉ √°nh x·∫° c√°c thanh ghi ph·∫ßn c·ª©ng, gi√∫p truy c·∫≠p v√† thao t√°c v·ªõi t·ª´ng bit d·ªÖ d√†ng.
```C
#include <stdio.h>

struct Register {
    unsigned int bit0 : 1;
    unsigned int bit1 : 1;
    unsigned int bit2 : 1;
    unsigned int reserved : 5;
};

int main() {
    struct Register reg = {1, 0, 1, 0};

    printf("Bit 0: %u\n", reg.bit0);
    printf("Bit 1: %u\n", reg.bit1);
    printf("Bit 2: %u\n", reg.bit2);

    return 0;
}
```
### 2. Qu·∫£n l√Ω tr·∫°ng th√°i
Bit-field c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ l∆∞u tr·ªØ tr·∫°ng th√°i c·ªßa nhi·ªÅu thi·∫øt b·ªã ho·∫∑c c·ªù (flags) trong m·ªôt bi·∫øn duy nh·∫•t.
```C
#include <stdio.h>

struct DeviceStatus {
    unsigned int power : 1;
    unsigned int error : 1;
    unsigned int ready : 1;
};

int main() {
    struct DeviceStatus status = {1, 0, 1};

    printf("Power: %u\n", status.power);
    printf("Error: %u\n", status.error);
    printf("Ready: %u\n", status.ready);

    return 0;
}
```