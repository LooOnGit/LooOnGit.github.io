---
title: "Dynamic"
date: 2025-11-02 11:03:05 +0800
categories: [C++]
tags: [C++]
---

# Dynamic In C++

## Cấp Phát Động Là Gì?
Một số lưu ý cần nhớ trong cấp phát động:
- Vùng nớ sử dụng khi cáp phát động là vùng nhớ **heap**.
- Lập trình viên cần giải phóng vùng nhớ để tránh rò rỉ bộ nhớ (leak memory).

## Toán Tử New Và Delete 

### syntax New
```c
pointer = new data_type
pointer = new data_type [num_of_elements]
```

Cú pháp thứ nhất sẽ xin cấp phát 1 phần tử còn cú pháp thứ 2 xin cấp phát 1 khối.

**Example:**
```c
#include <iostream>

using namespace std;

int main(){
    int *ptr = new int[5];
    cout << "Gia tri cua ptr : " << ptr << endl;
    ptr[0] = 1;
    ptr[1] = 2;
    ptr[2] = 3;
    ptr[3] = 4;
    ptr[4] = 5;
    for(int i = 0; i < 5; i++){
        cout << ptr[i] << ' '; // hoac *(ptr + i)
    }
}
```
**Output**:
```c
Gia tri cua ptr : 0xca1510
1 2 3 4 5 
```
Trong trường hợp vùng nhớ heap không đủ cấp phát thì chương trình sẽ ném ra ngoại lệ và trả về null.

### Cơ chế nothrow
Để tránh chương trình gặp lỗi dùng cơ thể này ptr sẽ trả về null nếu không đủ bộ nhớ cấp phát.

```c 
#include <iostream>

using namespace std;

int main(){
    int *ptr = new(nothrow) int[10000000000000ll];
    if(ptr == NULL){
        cout << "Khong du bo nho cap phat !\n";
    }
    return 0;
}
```
**Output:**
Khong du bo nho cap phat !

## Toán tử delete:
Dùng để giải phóng vùng nhớ đã cấp phát troớc đó từ toán tử new. Việc này là cần thiết để tránh viẹc leak memory.

### Syntax
```c
delete pointer;
delete [] pointer;
```

Cú pháp thứ nhất để giải phóng vùng nhớ 1 phần tử được cấp phát trước đó còn cú pháp thứ 2 dùng khi bạn đã xin cấp phát 1 mảng các phần tử.

**Example:**
```c
#include <iostream>

using namespace std;

int main(){
    int n; cout << "Nhap so luong phan tu xin cap phat : ";
    cin >> n;
    int *ptr = new(nothrow) int[n];
    if(ptr == NULL){
        cout << "Khong du bo nho cap phat !\n";
    }
    else{
        cout << "Nhap cac phan tu trong day : ";
        for(int i = 0; i < n; i++){
            cin >> ptr[i];
        }
        cout << "Cac phan tu vua nhap : ";
        for(int i = 0; i < n; i++){
            cout << ptr[i] << ' ';
        }
        delete []ptr;
    }
    return 0;
}
```